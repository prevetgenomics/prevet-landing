---
import { getCollection, render } from "astro:content";
import Layout from "../../layouts/Layout.astro";
import Section from "../../layouts/Section.astro";
import DateTime from "../../components/DateTime.astro";
import ArrowLink from "../../components/ArrowLink.astro";

export async function getStaticPaths() {
  const posts = await getCollection("blog");
  return posts.map((post) => ({
    params: { slug: post.data.slug },
    props: { post },
  }));
}

export const prerender = true;

const { post } = Astro.props;
const { Content } = await render(post);
---

<Layout subtitle=`Blog - ${post.data.title}`>
  <Section>
    <article class="mx-auto max-w-prose py-4">
      <h1 class="mb-8 flex justify-center text-wrap">
        {post.data.title}
      </h1>
      <div
        class="mb-1 flex flex-col items-center justify-between space-y-2 sm:flex-row sm:items-baseline"
      >
        <p>
          Escrito por {post.data.author}
        </p>
        <DateTime date={post.data.pubDate} />
      </div>
      <hr class="text-accent mb-5 rounded-2xl border-1" />

      <div class="prose">
        <Content />
      </div>
      <div class="flex justify-center pt-6">
        <ArrowLink content="Todas las publicaciones" link="/blog" />
      </div>
    </article>
  </Section>

  <Section currentColor="bg-section" />
</Layout>
